<!DOCTYPE html>
<html>
    <head>
        <title>Excel to vCard Converter - Bulk Contact Import</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
        <style>
            body {
               background-image: url('https://khanvani.github.io/aol/images/srisri.jpg'); 
                background-size: cover;
            }
            .white {
                color: white;
            }
        </style>
    </head>
    <body>
        <div class="container-fluid mt-5">
			<div class="row justify-content-end">
                <div class="col-5" style="margin-right: 50px;margin-top: 50px;">
                    <h1 class="text-center white">Excel to vCard Converter</h1>
                    <h3 class="text-center white">Easily Import Bulk Contacts From Excel to Your Mobile</h3>
                    <div class="card mt-4">
                        <div class="card-body">
                            <form id="upload-form">
                                <div class="form-group">
                                    <label for="excel-file">Step 1: Please select an excel file</label>
                                    <input type="file" class="form-control-file" id="excel-file">
    								<span id="error-msg" class="text-danger" hidden>Please upload a valid .xlsx file</span>
                                </div>
                                <button type="submit" id="next-button" class="btn btn-primary float-right" disabled>Next</button>
                            </form>
                            <form id="conversion-form" style="display:none">
                                <div class="form-group">
                                    <label for="name-prefix">Name Prefix: (If you want to add any prefix to Name)</label>
                                    <input type="text" id="name-prefix" class="form-control">
                                </div>
                                <div class="form-group">
									<label for="name-column">Name:</label>
									<select class="form-control" id="name-column" required></select>
									<small id="nameError" class="form-text text-danger" style="display:none;">Name is required.</small>
								</div>
								<div class="form-group">
									<label for="contact1-column">Contact Number:</label>
									<select class="form-control" id="contact1-column" required></select>
									<small id="contact1Error" class="form-text text-danger" style="display:none;">Contact Number is required.</small>
								</div>
                                <div class="form-group">
                                    <label for="contact2-column">Alternate Number: </label>
                                    <select class="form-control" id="contact2-column"></select>
                                </div>
                                <div class="form-group">
                                    <label for="email-column">Email:</label>
                                    <select class="form-control" id="email-column"></select>
                                </div>
                                <div class="form-group">
                                    <label for="address-column">Address:</label>
                                    <select class="form-control" id="address-column"></select>
                                </div>
                                <div class="form-group">
                                    <label for="url-column">URL:</label>
                                    <select class="form-control" id="url-column"></select>
                                </div>
                                <div class="form-group">
                                    <label for="bday-column">Birthday:</label>
                                    <select class="form-control" id="bday-column"></select>
                                </div>
                                <!-- Add more column selectors as needed -->
                                <div class="form-group">
                                    <label for="org-column">Organization:</label>
                                    <select class="form-control" id="org-column"></select>
                                </div>
                                <div class="form-group">
                                    <label for="groupInfo-column">Group:</label>
                                    <select class="form-control" id="groupInfo-column"></select>
                                </div>
								
								<button type="button" id="back-button" class="btn btn-secondary float-left">Back</button>    
								<button type="submit" class="btn btn-primary float-right">Convert and Download</button>
                            </form>
                        </div>
                    </div>
                    <footer class="mt-4 text-center white">
                        <p>Developed By Rahul Khanvani</p>
                        <a href="https://www.linkedin.com/in/rahul-khanvani" target="_blank"><i class="fab fa-linkedin fa-2x mx-2 white"></i></a>
                        <a href="https://www.instagram.com/rahul.khanvani" target="_blank"><i class="fab fa-instagram fa-2x mx-2 white"></i></a>
                        <a href="https://www.facebook.com/khanvani.rahul" target="_blank"><i class="fab fa-facebook fa-2x mx-2 white"></i></a>
                        <p class="mt-3">&copy; 2022 Rahul Khanvani - All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
       
        
        <script>
		document.addEventListener("DOMContentLoaded",(e=>{var t,n;document.getElementById("excel-file").addEventListener("change",(function(e){var o=e.target.files[0];o=e.target.files[0];if("xlsx"!==o.name.split(".").pop())return document.getElementById("error-msg").hidden=!1,void(document.getElementById("next-button").disabled=!0);document.getElementById("error-msg").hidden=!0,document.getElementById("next-button").disabled=!1;var d=new FileReader;d.onload=function(e){var o=new Uint8Array(e.target.result),d=XLSX.read(o,{type:"array"}),l=d.SheetNames[0],m=d.Sheets[l];n=XLSX.utils.sheet_to_json(m,{header:1}),t=n[0];for(var u of["name-column","contact1-column","contact2-column","email-column","address-column","url-column","bday-column","org-column","groupInfo-column"]){var c=document.getElementById(u),a=document.createElement("option");a.text="",a.value="",c.add(a);for(var r=0;r<t.length;r++){var i=document.createElement("option");i.text=t[r],i.value=r,c.add(i)}}},d.readAsArrayBuffer(o)}),!1),document.getElementById("upload-form").addEventListener("submit",(function(e){e.preventDefault(),document.getElementById("upload-form").style.display="none",document.getElementById("conversion-form").style.display="block"})),document.getElementById("conversion-form").addEventListener("submit",(function(e){e.preventDefault();var t=document.getElementById("name-column").value,o=document.getElementById("contact1-column").value;if(document.getElementById("nameError").style.display="none",document.getElementById("contact1Error").style.display="none",!t)return void(document.getElementById("nameError").style.display="block");if(!o)return void(document.getElementById("contact1Error").style.display="block");var d=document.getElementById("name-prefix").value||"",l=(t=document.getElementById("name-column").value,o=document.getElementById("contact1-column").value,document.getElementById("contact2-column").value),m=document.getElementById("email-column").value,u=document.getElementById("address-column").value,c=document.getElementById("url-column").value,a=document.getElementById("bday-column").value,r=document.getElementById("org-column").value,i=document.getElementById("groupInfo-column").value,y=n.slice(1).reduce((function(e,n){return e+"BEGIN:VCARD\nVERSION:2.1\n"+(t?"N:;"+d+n[t]+";;;\n":"")+(t?"FN:"+d+n[t]+"\n":"")+(o?"TEL;CELL:"+n[o]+"\n":"")+(l?"TEL;HOME:"+n[l]+"\n":"")+(m?"EMAIL:"+n[m]+"\n":"")+(u?"ADR:"+n[u]+"\n":"")+(c?"URL:"+n[c]+"\n":"")+(a?"BDAY:"+n[a]+"\n":"")+(r?"ORG:"+n[r]+"\n":"")+(i?"NOTE:"+n[i]+"\n":"")+"END:VCARD\n"}),""),s="data:text/plain;charset=utf-8,"+encodeURIComponent(y),E=document.createElement("a");E.setAttribute("href",s),E.setAttribute("download","contacts.vcf"),E.click()})),document.getElementById("back-button").addEventListener("click",(function(){document.getElementById("conversion-form").style.display="none",document.getElementById("upload-form").style.display="block"}))}));
        </script>
    </body>
</html>